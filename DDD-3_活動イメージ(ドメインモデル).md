# ドメインモデル

---
## コアドメイン / 全体
``` plantuml
@startuml
skinparam monochrome true
skinparam handwritten false
skinparam defaultFontName "Yu Gothic UI, sans-serif"
class 案件 {
    SFA情報
}
class 取引先 {
}
class 与信 {
    内部与信
    外部与信
    審査()
}
class 契約先 {
}
class 決済先 {
}
与信 -o 取引先 : 信用
取引先 <|-- 契約先 : 契約相手(名義)
取引先 <|-- 決済先 : 決済相手
class 決済条件 {
    クレカ
    代引き
    銀行振込
    後払い
    コンビニ払い
    キャリア決済
    スマホ決済
}
決済条件 --* 決済先 : 決済
class 契約 {
    対象サービス
    料金メニュー
    ステータス
    期間
}
案件 .o 契約 : 案件受注
契約先 "1"<--"*" 契約 : 得意先/仕入先
決済先 "0.1"<--"*" 契約 : 請求先/支払先
interface 取引 {
    サービス#
    プロビジョニング()
}
契約 o- 取引 : 取引発生
interface 実績
取引 "0..1"<."*" 実績 : サービス#
class 商品 {
    仕様
    料金
}
note right
ガス・電気
サービス・商品
endnote
商品 <-- 契約 : 購入
class 取引履歴 {
    折衝履歴
    業務履歴
}
取引先 o- 取引履歴 : (集約)
package 補助簿 {
    class 固定資産台帳 {
        会計上必要情報
        取得_売却_除却()
        減価償却()
    }
    取引 --> 固定資産台帳 : 資産取得/活用/廃棄
    package 補助簿_仕入先 {
        class 仕入帳 {
            仕入先
            仕入高
        }
        取引 --> 仕入帳 : 仕入勘定(定額分)
        class 買掛金元帳 {
            仕入先
            仕掛金
        }
        仕入帳 -* 買掛金元帳
    }
    package 補助簿_得意先 {
        class 売上帳 {
            得意先
            売上金
        }
        取引 --> 売上帳 : 売上勘定(定額分)
        class 売掛金元帳 {
            得意先
            売掛金
        }
        売上帳 -* 売掛金元帳
    }
}
class 現物台帳 {
    設置場所
    維持管理_修繕記録
    コンディション
    資産管理番号
    棚卸()
}
固定資産台帳 <.. 現物台帳
package 主要簿 {
    class 仕訳帳 {
        発生日
        借方_勘定科目
        借方_金額
        借方_摘要
        貸方_勘定科目
        貸方_金額
        貸方_摘要
        _粗利()
        _営業利益()
    }
    補助簿 --> 仕訳帳 : 売上勘定/仕入勘定(定額分)の計上
    class 総勘定元帳 {
        勘定科目
        金額
        財務状態()
    }
    仕訳帳 -> 総勘定元帳 : リアルタイム経営
    <> 販管費
    販管費 -> 仕訳帳 : 販管費の計上
}
package 料金計算 {
    class 計算根拠 {
        計上期
        対象マス)タ
        対象契約
        対象実績
        実行(計上期)
    }
    note right
    得意先と実績ベース精算分
    仕入先と実績ベース精算分
    endnote
    class 従量金額 {
        計上期
        従量金額
        実行(計上期)
    }
    class 売上情報 {
        計上期
        売上情報
        実行(計上期)
    }
    class 請求情報 {
        計上期
        得意先
        請求情報
        実行(計上期)
    }
    class 支払情報 {
        計上期
        仕入先
        支払情報
        実行(計上期)
    }
    従量金額 o-- 計算根拠 : 料金計算の根拠
    仕訳帳 "1"<--"1" 従量金額 : 売上&仕入勘定(従量分)
'    仕訳帳 "1"<--"1" 定額金額 : 売上勘定/仕入勘定(定額分)
    仕訳帳 "*"-->"1" 売上情報 : 売上計上
    仕訳帳 "*"-->"1" 請求情報 : 請求計上
    仕訳帳 "*"-->"1" 支払情報 : 支払計上
 }
 package 財務会計 {
    class 決算 {
        損益計算書
        貸借対照表
        キャッシュフロー計算書
        月次決算()
        四半期決算()
        年次決算()
    }
    総勘定元帳 --> 決算
 }
 package 管理会計 {
    class 予算管理 {
    }
    class 原価管理 {
    }
 }
 財務会計 .. 管理会計
@enduml
```
---
## サブドメイン / 債権&債務管理
``` plantuml
@startuml
skinparam monochrome true
skinparam handwritten false
skinparam defaultFontName "Yu Gothic UI, sans-serif"
package 料金計算 {
    interface 売上情報
    interface 請求情報
    interface 支払情報
 }
 package 債権管理 {
    interface 売上業務
    売上業務 -- 売上情報 : 商品受渡/役務提供
    interface 債権残高管理
    債権残高管理 -- 請求情報 : 売掛債権回収
    interface 滞留債権対応
    債権残高管理 - 滞留債権対応 : 未収/回収不能
    interface 値引割戻1
    値引割戻1 .. 売上情報 : 売上値引/売上割戻(都度)
 }
 package 債務管理 {
    interface 購買業務
    interface 債務残高管理
    支払情報 -- 債務残高管理 : 買掛金の管理
    interface 値引割戻2
    売上情報 -- 値引割戻2 : 売上値引/売上割戻(都度)
 }
<> 資産購入
資産購入 -- 購買業務 : 資産取得
@enduml
```
---
## 凡例
    関連 (Association) -- : 関係あり(必須)
                       .. : 関係あり(オプション)
    集約 (Aggregation) o-- : 親子は別々の関係
    構成 (Composition) *-- : 親子は共存の関係
    一般化と継承 (Extension) <|-- : 共通と個別の関係
