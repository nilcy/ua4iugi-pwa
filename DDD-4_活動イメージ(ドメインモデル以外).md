# ドメイン駆動設計(DDD)の活動イメージ(ドメインモデル以外)

---
## モデリング活動と成果物マップ
1. 業務分析-#1. ビジネス全体のスコープを関係者間で把握する
2. 業務分析-#2. ビジネスで扱う要素を洗い出す
3. 業務分析-#3. 要素に対するイベントを洗い出す
4. 業務分析-#4. 業務フローを記述する
5. 業務分析-#5. ToBeの分析を行う
6. 要件定義-#1. ラフなユースケースモデルを作成する
7. 要件定義-#2. ユースケースモデルをブラッシュアップする
8. 要件定義-#3. 画面・帳票仕様を作成する
9. 要件定義-#4. ドメインモデルを作成する
10. 要件定義-#5. ロバストネス図を作成する
11. 方式設計-#1. アプリケーションを標準化する
12. 概要設計-#1. 設計クラス図を作成する
13. 概要設計-#2. シーケンス図を作成する
14. 概要設計-#3. クラス仕様を作成する
---
## ユースケース図
    受領したモデルが大きすぎて見通しが悪くて維持管理しにくいです。
    > 全体俯瞰LV1と個別詳細LV2に階層化したほうがいいです。
    受領したモデルは共通化(include)のネストが深すぎます
    > 機能設計上の機能共通化に限定すべきです。(ロバストネス図のboundary)
    > 深すぎユースケースはロバストネス図のcontrolで整理すべきです。
    各ユースケースのメインフローなど各種仕様はユースケース記述に記入すべきです。
    上記ユースケース記述の処理仕様が基本構造で実現できるようドメインモデルを作成します。(結果、用語辞書の役割にもなります)
``` plantuml
@startuml
skinparam monochrome true
skinparam handwritten false
skinparam defaultFontName "Yu Gothic UI, sans-serif"
left to right direction

actor ユーザ
usecase 個別ユースケース1
usecase 個別ユースケース2
usecase 共通ユースケース

ユーザ --> 個別ユースケース1
ユーザ --> 個別ユースケース2
個別ユースケース1 --> 共通ユースケース : include
個別ユースケース2 --> 共通ユースケース : include

@enduml
```
---
## ロバストネス図
対象ステレオタイプは以下を参考にしてください
1. バウンダリ(boundary)：システムとシステム外部との境界になるクラス
2. コントロール(control)：ひとつまたは複数のユースケースに特有の、制御に関する振る舞いを持つクラス
3. エンティティ(entity)：問題領域に関連するクラス

以下の図を参考に作成してください
``` plantuml
@startuml
skinparam monochrome true
skinparam handwritten false
skinparam defaultFontName "Yu Gothic UI, sans-serif"
left to right direction

actor ユーザ
boundary 任意情報検索画面
boundary 任意情報一覧画面
boundary 任意情報閲覧ボタン
boundary 任意情報閲覧画面
boundary 任意情報変更ボタン
boundary 任意情報変更画面
control 任意情報検索処理
control 任意情報操作処理
entity 任意情報

ユーザ --> 任意情報検索画面
ユーザ <-- 任意情報一覧画面
ユーザ --> 任意情報閲覧ボタン
ユーザ <-- 任意情報閲覧画面
ユーザ --> 任意情報変更ボタン
ユーザ <--  任意情報変更画面
任意情報検索画面 --> 任意情報検索処理
任意情報一覧画面 <-- 任意情報検索処理
任意情報閲覧ボタン --> 任意情報操作処理
任意情報閲覧画面 <-- 任意情報操作処理
任意情報変更ボタン --> 任意情報操作処理
任意情報変更画面 <-- 任意情報操作処理
任意情報検索処理 --> 任意情報
任意情報操作処理 --> 任意情報

@enduml
```
---
## 設計クラス図
対象ステレオタイプは以下を参考にしてください
1. バウンダリ(boundary)：システムとシステム外部との境界になるクラス
2. コントロール(control)：ひとつまたは複数のユースケースに特有の、制御に関する振る舞いを持つクラス
3. エンティティ(entity)：問題領域に関連するクラス
4. 例外処理(exception)：例外のクラス
5. ユーティリティ(utility)：汎用のユースケース、またはユースケースに共通なクラス

以下の図を参考に作成してください
``` plantuml
@startuml
skinparam monochrome true
skinparam handwritten false
skinparam defaultFontName "Yu Gothic UI, sans-serif"
package アプリケーション {
class 任意情報画面 <<boundary>> {
    任意情報検索画面()
    任意情報一覧画面()
    任意情報閲覧ボタン()
    任意情報閲覧画面()
    任意情報変更ボタン()
    任意情報変更画面()
}
class 任意情報コントローラ <<control>> {
    検索画面ロジック処理()
    操作画面ロジック処理()
}
class 任意情報サービス <<control>> {
    検索トランザクション処理()
    操作トランザクション処理()
}
class 任意情報ドメイン <<control>> {
    検索ビジネスロジック処理()
    操作ビジネスロジック処理()
}
class 任意情報リポジトリ <<control>> {
    検索データIO処理()
    操作データIO処理()
}
class 任意情報エンティティ <<entity>> {
    任意情報
}
class ゲートウェイ <<control>> {
    外部サービス連携()
}
任意情報画面 --> 任意情報コントローラ : 画面ロジック呼出
任意情報コントローラ --> 任意情報サービス : 業務トランザクション呼出
'任意情報コントローラ --> 任意情報ドメイン : ドメイン呼出
'任意情報コントローラ --> 任意情報リポジトリ : リポジトリ呼出
任意情報サービス --> 任意情報ドメイン : ビジネスロジック呼出
任意情報サービス --> 任意情報リポジトリ : データロジック呼出
任意情報リポジトリ --> 任意情報エンティティ : データマッパー
' 任意情報コントローラ --> ゲートウェイ : ゲートウェイ呼出
任意情報サービス --> ゲートウェイ : 外部サービス呼出
}
class 外部サービス <<boundary>>
ゲートウェイ --> 外部サービス : 外部サービスAPI
@enduml
```
---
## シーケンス図
対象ステレオタイプは以下を参考にしてください
1. バウンダリ(boundary)：システムとシステム外部との境界になるクラス
2. コントロール(control)：ひとつまたは複数のユースケースに特有の、制御に関する振る舞いを持つクラス
3. エンティティ(entity)：問題領域に関連するクラス
4. 例外処理(exception)：例外のクラス
5. ユーティリティ(utility)：汎用のユースケース、またはユースケースに共通なクラス

以下の図を参考に作成してください
``` plantuml
@startuml
skinparam monochrome true
skinparam defaultFontName "Yu Gothic UI, sans-serif"
autonumber
actor 任意情報画面
control 任意情報コントローラ
control 任意情報サービス
control 任意情報ドメイン
control 任意情報リポジトリ
control ゲートウェイ
entity 任意情報エンティティ
actor 外部サービス
任意情報画面 -> 任意情報コントローラ : 画面ロジック呼出
任意情報コントローラ -> 任意情報サービス : 業務トランザクション呼出
任意情報サービス -> 任意情報ドメイン : ビジネスロジック呼出
任意情報サービス -> 任意情報リポジトリ : データロジック呼出
任意情報リポジトリ -> 任意情報エンティティ : データマッパー
任意情報サービス -> ゲートウェイ : 外部サービス呼出
ゲートウェイ -> 外部サービス : 外部サービスAPI
@enduml
```
---
## 凡例
    関連 (Association) -- : 関係あり(必須)
                       .. : 関係あり(オプション)
    集約 (Aggregation) o-- : 親子は別々の関係
    構成 (Composition) *-- : 親子は共存の関係
    一般化と継承 (Extension) <|-- : 共通と個別の関係
